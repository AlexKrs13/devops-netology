## Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей

### Задача 1
```text
Опишите кратко, в чём основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.
```
Основное отличие заключается в предъявляемых требованиях к ядру гостевой ОС.
#### 1. Полная (аппаратная) виртуализация:   
Все ВМ полностью независимы и работают под управлением собственных ОС. Модификация ядра ОС для ВМ не требуется. 
Гипервизор имеет прямой доступ к дисковому пространству и ресурсам процессора физического сервера, а также управляет распределением ресурсов каждой ВМ.
#### 2. Паравиртуализация:
Гостевые ОС подготавливаются для исполнения в виртуализированной среде посредством незначительной модификации ядра. 
Модификация ядра гостевой ОС необходима для взаимодействия с программой гипервизора через API.
#### 3. Виртуализация на основе ОС:
Хостовая ОС сама отвечает за разделение аппаратных ресурсов между несколькими виртуальными серверами и поддержку их независимости друг от друга. 
Виртуализация на основе ОС не позволяет запускать ВМ, если ядро ОС отличается от ядра базовой ОС.

### Задача 2
```text
Выберите один из вариантов использования организации физических серверов в зависимости от условий использования.

Организация серверов:
физические сервера,
паравиртуализация,
виртуализация уровня ОС.

Условия использования:
высоконагруженная база данных, чувствительная к отказу;
различные web-приложения;
Windows-системы для использования бухгалтерским отделом;
системы, выполняющие высокопроизводительные расчёты на GPU.
Опишите, почему вы выбрали к каждому целевому использованию такую организацию.
```

<table>
    <thead>
        <tr>
            <th>Организация серверов</th>
            <th>Условия использования </th>
            <th>Описание</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td align="center">Физические сервера</td>
            <td align="center">Высоконагруженная база данных, чувствительная к отказу</td>
            <td align="center">
                Виртуальные машины работают на аппаратном уровне с эмуляцией сервера, очень близкого к физическому.
                Нет особого влияния соседних ВМ или физического сервера в целом (т.е. ресурсы ВМ максимально изолированы).
            </td>
        </tr>
        <tr>
            <td align="center">Паравиртуализация</td>
            <td align="center">Windows-системы для использования бухгалтерским отделом</td>
            <td align="center">
                Для Windows систем - это использование Hyper-V.
                Высокая скорость работы ВМ за счет отсутствия эмуляции аппаратуры.
            </td>
        </tr>
        <tr>
            <td rowspan=2 align="center">Виртуализация уровня ОС</td>
            <td align="center">Различные web-приложения</td>
            <td align="center">Запуск таких приложений целесообразно выполнять в контейнерах нежели чем выделять отдельную ВМ с ОС, потребляющей физические ресурсы</td>
        </tr>
        <tr>
            <td align="center">Системы, выполняющие высокопроизводительные расчёты на GPU</td>
            <td align="center">Предоставление одних и тех же GPU ресурсов нескольким ВМ за счет того, что не все виртуальные машины используют свой максимум ресурсов в расчетах</td>
        </tr>
    </tbody>
</table>

### Задача 3
```text
Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.
```
```text
100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based-инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
```
Если преимущественно Windows based-инфраструктура, то целесообразно использовать Hyper-V.
Поддержка SMB, NTFS, для репликации данных DFS.
Можно также рассмотреть VMware vSphere - поддерживаются Linux, Windows, Solaris, Netware, FreeBSD, MacOS.
Имеет удобное управление и мониторинг.
```text
Требуется наиболее производительное бесплатное open source-решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
```
XEN для Windows не подходит, целесообразно тогда взять KVM.
У нас в конторе для массового разворачивания ВМ использовался OpenStack. Бесплатное, производительное и надежное решение.
Для обеспечения производительной и отказоустойчивой файловой системы ВМ использовали Ceph на SSD дисках в связке с OpenStack.
```text
Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows-инфраструктуры.
```
Microsoft Hyper-V Server - бесплатная серверная версия гипервизора и родного решения для Windows дистрибутивов.
```text
Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.
```
Целесообразно использовать KVM, основывается на ядре Linux.
Для подключения гипервизора KVM нужен только сервер с процессором Intel-VT/AMD-V.
XEN можно поставить не на все дистрибутивы, только на Debian, CentOS, Fedora с модифицированным ядром.
VMware vSphere 6 придется купить и лицензии на каждый процессор на сервере.

### Задача 4
```text
Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) 
и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, создавали бы вы гетерогенную среду или нет? 
Мотивируйте ваш ответ примерами.
```
Если коротко, то скорее нет, чем да:  
* Гетерогенная среда предполагает значительные затраты на штат сотрудников и их регулярное обучение;  
* Возможны проблемы с совместимостью с компонентами железа;  
* В больших масштабах требуется поддержка кластеризации, удобные подсистемы мониторинга и алертинга.  
Получается так, что если это маленькая компания, где есть 1-2 технических специалиста, то они физически не справятся с множеством систем управления. Нанимать большой штат не целесообразно. 
Собственник посчитает стоимость владения стеком технологий и уйдет в yandex cloud.  
Большие компании стараются все унифицировать, т.к. требуется документировать всю деятельность специалистов, соответствовать требованиям ИБ, соответствовать масштабу компании с запасом на развитие. 
Сюда же добавляются SLA, обязательная (зачастую) поддержка решения вендором и прочее.